<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.neuedu.yyzx.mapper.OutwardMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.neuedu.yyzx.pojo.Outward">
        <id column="id" property="id" />
        <result column="remarks" property="remarks" />
        <result column="is_deleted" property="isDeleted" />
        <result column="customer_id" property="customerId" />
        <result column="outgoingreason" property="outgoingreason" />
        <result column="outgoingtime" property="outgoingtime" />
        <result column="expectedreturntime" property="expectedreturntime" />
        <result column="actualreturntime" property="actualreturntime" />
        <result column="escorted" property="escorted" />
        <result column="relation" property="relation" />
        <result column="escortedtel" property="escortedtel" />
        <result column="auditstatus" property="auditstatus" />
        <result column="auditperson" property="auditperson" />
        <result column="audittime" property="audittime" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id,remarks, is_deleted, customer_id, outgoingreason, outgoingtime, expectedreturntime, actualreturntime,
        escorted,relation,escortedtel,auditstatus,auditperson,audittime
    </sql>
    <!--    通过当前登录护工查询对应客户信息-->
    <select id="selectOutwardVo" resultType="OutwardVo">
        select distinct
        u.nickname,
        u.phone_number,
        ow.id,
        ow.remarks,
        ow.is_deleted,
        ow.customer_id,
        ow.outgoingreason,
        ow.outgoingtime,
        ow.expectedreturntime,
        ow.actualreturntime,
        ow.escorted,
        ow.relation,
        ow.escortedtel,
        ow.auditstatus,
        ow.auditperson,
        ow.audittime,
        cs.customer_name
        from outward ow,user u,customer cs
        where cs.user_id=u.id
        and ow.customer_id = cs.id
        and ow.is_deleted=0
        <if test="userId!=null and userId!=''">
            and cs.user_id=#{userId}
        </if>

    </select>


</mapper>
